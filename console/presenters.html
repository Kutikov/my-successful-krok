<!doctype html>

<html lang="en">

<head>
    <meta charset="utf-8">

    <title>My successful KROK blog</title>
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
    <meta name="description" content="">
    <meta name="author" content="Damir A. Kutikov">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <script src="https://www.gstatic.com/firebasejs/8.7.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.7.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.7.1/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.7.1/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.7.1/firebase-storage.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.0.0/crypto-js.min.js"></script>
    <link href="https://unpkg.com/material-components-web@latest/dist/material-components-web.min.css" rel="stylesheet">
    <script src="https://unpkg.com/material-components-web@latest/dist/material-components-web.min.js"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link href="style.css" rel="stylesheet">
    <script src="Unit.js"></script>
    <script src="Fork.js"></script>
    <script src="FireBaseAPI.js"></script>
    <script src="presenters/Presenter.js"></script>
    <script src="presenters/FileP.js"></script>
    <script src="presenters/ImageP.js"></script>
    <script src="presenters/InfoCard.js"></script>
    <script src="presenters/LinkP.js"></script>
    <script src="presenters/Paragraph.js"></script>
    <script src="presenters/TestProgram.js"></script>
    <script src="presenters/VideoP.js"></script>
</head>

</head>

<body style="background-color: #f0f0f0;">
    <div style="display: flex; bottom: 0; top: 0; right: 0; left: 0; position: absolute; flex-direction: column; align-items: center;">
        <div style="display: flex; flex-direction: row; align-items: center;flex-grow: 0; flex-shrink: 0; flex-wrap: wrap;">
            <div class="mdc-select mdc-select--outlined" style="margin-top: 16px; margin-left: 16px; margin-right: 16px; margin-bottom: 8px;  flex-grow: 1;  flex-shrink: 1;">
                <div class="mdc-select__anchor" aria-labelledby="outlined-select-label">
                    <span class="mdc-notched-outline">
                        <span class="mdc-notched-outline__leading"></span>
                        <span class="mdc-notched-outline__notch">
                            <span id="outlined-select-label" class="mdc-floating-label">Модуль</span>
                        </span>
                        <span class="mdc-notched-outline__trailing"></span>
                    </span>
                    <span class="mdc-select__selected-text-container">
                        <span id="forks-selected-text" class="mdc-select__selected-text"></span>
                    </span>
                    <span class="mdc-select__dropdown-icon">
                        <svg class="mdc-select__dropdown-icon-graphic" viewBox="7 10 10 5" focusable="false">
                        <polygon class="mdc-select__dropdown-icon-inactive" stroke="none" fill-rule="evenodd" points="7 10 12 15 17 10"></polygon>
                        <polygon class="mdc-select__dropdown-icon-active" stroke="none" fill-rule="evenodd" points="7 15 12 10 17 15"></polygon>
                    </svg>
                  </span>
                </div>
                <div class="mdc-select__menu mdc-menu mdc-menu-surface mdc-menu-surface--fullwidth">
                    <ul id="forksList" class="mdc-list"></ul>
                </div>
            </div>
            <div class="mdc-select mdc-select--outlined" style="margin-top: 16px; margin-left: 16px; margin-right: 16px; margin-bottom: 8px; flex-grow: 1; flex-shrink: 1;">
                <div class="mdc-select__anchor" aria-labelledby="outlined-select-label">
                    <span class="mdc-notched-outline">
                        <span class="mdc-notched-outline__leading"></span>
                        <span class="mdc-notched-outline__notch">
                            <span id="outlined-select-label" class="mdc-floating-label">Лекция</span>
                        </span>
                        <span class="mdc-notched-outline__trailing"></span>
                    </span>
                    <span class="mdc-select__selected-text-container">
                        <span id="units-selected-text" class="mdc-select__selected-text"></span>
                    </span>
                    <span class="mdc-select__dropdown-icon">
                        <svg class="mdc-select__dropdown-icon-graphic" viewBox="7 10 10 5" focusable="false">
                        <polygon class="mdc-select__dropdown-icon-inactive" stroke="none" fill-rule="evenodd" points="7 10 12 15 17 10"></polygon>
                        <polygon class="mdc-select__dropdown-icon-active" stroke="none" fill-rule="evenodd" points="7 15 12 10 17 15"></polygon>
                    </svg>
                  </span>
                </div>
                <div class="mdc-select__menu mdc-menu mdc-menu-surface mdc-menu-surface--fullwidth">
                    <ul id="unitsList" class="mdc-list"></ul>
                </div>
            </div>
            <div style="display: flex; margin-left:16px; flex-grow: 1; flex-shrink: 0;">
                
                <button class="mdc-button mdc-button--raised" id="saveButton" style="margin-right:16px; margin-top: 8px; margin-bottom: 8px;" onclick="save_file();" disabled>
                    <span class="mdc-button__ripple"></span>
                    <i class="material-icons mdc-button__icon" aria-hidden="true">save</i>
                    <span class="mdc-button__label">Сохранить</span>
                </button>
            </div>
            
        </div>
        <div id="testListMainPage" class="testListMainPage">
            
        </div>
    </div>
    <button class="mdc-fab mdc-fab--extended" id="fab" style="position:fixed; bottom: 16px; right: 16px;">
        <div class="mdc-fab__ripple"></div>
        <span class="material-icons mdc-fab__icon">add</span>
        <span class="mdc-fab__label">Create</span>
    </button>
    <div id="main-dialog" class="mdc-dialog" role="alertdialog" aria-modal="true" aria-labelledby="mdc-dialog-with-list-label" aria-describedby="mdc-dialog-with-list-description" bis_skin_checked="1">
        <div class="mdc-dialog__scrim" bis_skin_checked="1"></div>
        <div class="mdc-dialog__container" bis_skin_checked="1">
            <div class="mdc-dialog__surface" bis_skin_checked="1">
                <h2 id="main-dialog-title" class="mdc-dialog__title">Измени</h2>
                <section id="main-dialog-content" class="mdc-dialog__content">

                </section>
                <footer class="mdc-dialog__actions">
                    <button type="button" class="mdc-button mdc-dialog__button mdc-ripple-upgraded" onclick="cancel()">Отмена</button>
                    <button type="button" class="mdc-button mdc-dialog__button mdc-ripple-upgraded" onclick="accept()">Сохранить</button>
                </footer>
            </div>
        </div>
    </div>
    
    <div id="edit-dialog" class="mdc-dialog" role="alertdialog" aria-modal="true" aria-labelledby="mdc-dialog-with-list-label" aria-describedby="mdc-dialog-with-list-description" bis_skin_checked="1">
        <div class="mdc-dialog__scrim" bis_skin_checked="1"></div>
        <div class="mdc-dialog__container" bis_skin_checked="1">
            <div class="mdc-dialog__surface" bis_skin_checked="1">
                <h2 id="edit_dialog-dialog-title" class="mdc-dialog__title">Изменить презентер</h2>
                <section id="edit_dialog-dialog-content" class="mdc-dialog__content">
                    
                    <div class="mdc-select mdc-select--outlined" style="margin-top: 4px; margin-bottom: 8px; width: 100%;">
                        <div class="mdc-select__anchor" aria-labelledby="outlined-select-label">
                            <span class="mdc-notched-outline">
                                <span class="mdc-notched-outline__leading"></span>
                                <span class="mdc-notched-outline__notch">
                                    <span id="outlined-select-label" class="mdc-floating-label">Тип презентера</span>
                                </span>
                                <span class="mdc-notched-outline__trailing"></span>
                            </span>
                            <span class="mdc-select__selected-text-container">
                                <span id="type-selected-text" class="mdc-select__selected-text"></span>
                            </span>
                            <span class="mdc-select__dropdown-icon">
                                <svg class="mdc-select__dropdown-icon-graphic" viewBox="7 10 10 5" focusable="false">
                                <polygon class="mdc-select__dropdown-icon-inactive" stroke="none" fill-rule="evenodd" points="7 10 12 15 17 10"></polygon>
                                <polygon class="mdc-select__dropdown-icon-active" stroke="none" fill-rule="evenodd" points="7 15 12 10 17 15"></polygon>
                            </svg>
                          </span>
                        </div>
                        <div class="mdc-select__menu mdc-menu mdc-menu-surface mdc-menu-surface--fullwidth">
                            <ul id="forksList" class="mdc-list">
                                <li class="mdc-list-item">
                                    <span class="mdc-list-item__ripple"></span>
                                    <span class="mdc-list-item__text"></span>
                                </li>
                                <li class="mdc-list-item">
                                    <span class="mdc-list-item__ripple"></span>
                                    <span class="mdc-list-item__text">paragraph</span>
                                </li>
                                <li class="mdc-list-item">
                                    <span class="mdc-list-item__ripple"></span>
                                    <span class="mdc-list-item__text">infocard</span>
                                </li>
                                <li class="mdc-list-item">
                                    <span class="mdc-list-item__ripple"></span>
                                    <span class="mdc-list-item__text">link</span>
                                </li>
                                <li class="mdc-list-item">
                                    <span class="mdc-list-item__ripple"></span>
                                    <span class="mdc-list-item__text">image</span>
                                </li>
                                <li class="mdc-list-item">
                                    <span class="mdc-list-item__ripple"></span>
                                    <span class="mdc-list-item__text">video</span>
                                </li>
                                <li class="mdc-list-item">
                                    <span class="mdc-list-item__ripple"></span>
                                    <span class="mdc-list-item__text">file</span>
                                </li>
                                <li class="mdc-list-item">
                                    <span class="mdc-list-item__ripple"></span>
                                    <span class="mdc-list-item__text">testprogram</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div style="width: 600px;"></div>
                    <div id="paragraphEditorHolder" style="width: 100%;">
                        <label class="mdc-text-field mdc-text-field--outlined mdc-text-field--textarea" style="margin-top: 8px;">
                            <span class="mdc-notched-outline">
                              <span class="mdc-notched-outline__leading"></span>
                              <span class="mdc-notched-outline__notch">
                                <span class="mdc-floating-label" id="taskEditLabel">Текст параграфа</span>
                              </span>
                              <span class="mdc-notched-outline__trailing"></span>
                            </span>
                            <span class="mdc-text-field__resizer">
                              <textarea class="mdc-text-field__input" id="paragraphEditTextArea" rows="4" cols="100" aria-label="Label" required minlength="3"></textarea>
                            </span>
                        </label>
                        <div style="display: flex; flex-direction: row; flex-wrap: wrap; justify-content: space-between;">
                            <button id="lf_paragraph" class="mdc-icon-button material-icons" onclick="disableSiblings('lf_paragraph', ['lf_paragraph', 'md_paragraph', 'rt_paragraph', 'jf_paragraph'])">format_align_left</button>
                            <button id="md_paragraph" class="mdc-icon-button material-icons" onclick="disableSiblings('md_paragraph', ['lf_paragraph', 'md_paragraph', 'rt_paragraph', 'jf_paragraph'])">format_align_center</button>
                            <button id="rt_paragraph" class="mdc-icon-button material-icons" onclick="disableSiblings('rt_paragraph', ['lf_paragraph', 'md_paragraph', 'rt_paragraph', 'jf_paragraph'])">format_align_right</button>
                            <button id="jf_paragraph" class="mdc-icon-button material-icons" onclick="disableSiblings('jf_paragraph', ['lf_paragraph', 'md_paragraph', 'rt_paragraph', 'jf_paragraph'])">format_align_justify</button>
                            <div style="width: 2px; background-color: #bbb; margin: 4px;"></div>
                            <button id="i_paragraph" class="mdc-icon-button material-icons" onclick="disableSiblings('i_paragraph', false)">format_italic</button>
                            <button id="b_paragraph" class="mdc-icon-button material-icons" onclick="disableSiblings('b_paragraph', false)">format_bold</button>
                            <button id="u_paragraph" class="mdc-icon-button material-icons" onclick="disableSiblings('u_paragraph', false)">format_underlined</button>
                            <div style="width: 2px; background-color: #bbb; margin: 4px;"></div>
                            <div style="width: 48px; height: 48px;" onclick="openPopup('alignPopupParagraph')">                            
                                <div id='alignPopupParagraph' style="z-index: 100; display: none; background: #eee; position: absolute; margin-top: -100px; border: 1px #eee solid; border-radius: 4px; box-shadow: #0000006c 0px 1px 4px 1px">
                                    <button id="xl_paragraph" class="mdc-icon-button material-icons" style="display: block;" onclick="disableSiblings('xl_paragraph', ['xl_paragraph', 'l_paragraph', 'm_paragraph', 's_paragraph', 'xs_paragraph'])">
                                        <svg style="width:24px;height:24px" viewBox="0 0 24 24">
                                            <path fill="currentColor" d="M3,4H5V10H9V4H11V18H9V12H5V18H3V4M14,18V16H16V6.31L13.5,7.75V5.44L16,4H18V16H20V18H14Z" />
                                        </svg>
                                    </button>
                                    <button id="l_paragraph" class="mdc-icon-button material-icons" style="display: block;" onclick="disableSiblings('l_paragraph', ['xl_paragraph', 'l_paragraph', 'm_paragraph', 's_paragraph', 'xs_paragraph'])">
                                        <svg style="width:24px;height:24px" viewBox="0 0 24 24">
                                            <path fill="currentColor" d="M3,4H5V10H9V4H11V18H9V12H5V18H3V4M21,18H15A2,2 0 0,1 13,16C13,15.47 13.2,15 13.54,14.64L18.41,9.41C18.78,9.05 19,8.55 19,8A2,2 0 0,0 17,6A2,2 0 0,0 15,8H13A4,4 0 0,1 17,4A4,4 0 0,1 21,8C21,9.1 20.55,10.1 19.83,10.83L15,16H21V18Z" />
                                        </svg>
                                    </button>
                                    <button id="m_paragraph" class="mdc-icon-button material-icons" style="display: block;" onclick="disableSiblings('m_paragraph', ['xl_paragraph', 'l_paragraph', 'm_paragraph', 's_paragraph', 'xs_paragraph'])">
                                        <svg style="width:24px;height:24px" viewBox="0 0 24 24">
                                            <path fill="currentColor" d="M3,4H5V10H9V4H11V18H9V12H5V18H3V4M15,4H19A2,2 0 0,1 21,6V16A2,2 0 0,1 19,18H15A2,2 0 0,1 13,16V15H15V16H19V12H15V10H19V6H15V7H13V6A2,2 0 0,1 15,4Z" />
                                        </svg>
                                    </button>
                                    <button id="s_paragraph" class="mdc-icon-button material-icons" style="display: block;" onclick="disableSiblings('s_paragraph', ['xl_paragraph', 'l_paragraph', 'm_paragraph', 's_paragraph', 'xs_paragraph'])">
                                        <svg style="width:24px;height:24px" viewBox="0 0 24 24">
                                            <path fill="currentColor" d="M3,4H5V10H9V4H11V18H9V12H5V18H3V4M18,18V13H13V11L18,4H20V11H21V13H20V18H18M18,11V7.42L15.45,11H18Z" />
                                        </svg>
                                    </button>
                                    <button id="xs_paragraph" class="mdc-icon-button material-icons" style="display: block;" onclick="disableSiblings('xs_paragraph', ['xl_paragraph', 'l_paragraph', 'm_paragraph', 's_paragraph', 'xs_paragraph'])">
                                        <svg style="width:24px;height:24px" viewBox="0 0 24 24">
                                            <path fill="currentColor" d="M3,4H5V10H9V4H11V18H9V12H5V18H3V4M15,4H20V6H15V10H17A4,4 0 0,1 21,14A4,4 0 0,1 17,18H15A2,2 0 0,1 13,16V15H15V16H17A2,2 0 0,0 19,14A2,2 0 0,0 17,12H15A2,2 0 0,1 13,10V6A2,2 0 0,1 15,4Z" />
                                        </svg>
                                    </button>
                                </div>
                                <button class="mdc-icon-button material-icons">format_size</button>
                            </div>
                            <div style="width: 48px; height: 48px;" onclick="openPopup('colorPopupParagraph')">                            
                                <div id='colorPopupParagraph' style="z-index: 100; display: none; background: #eee; position: absolute; margin-top: -250px; border: 1px #eee solid; border-radius: 4px; box-shadow: #0000006c 0px 1px 4px 1px">
                                    <div style="margin: 8px;width: 24px; height: 24px; flex-shrink: 0; background-color: #e53935;" onclick="selectColor('Red')"></div>
                                    <div style="margin: 8px; width: 24px; height: 24px; flex-shrink: 0; background-color: #c2185b;" onclick="selectColor('Pink')"></div>
                                    <div style="margin: 8px; width: 24px; height: 24px; flex-shrink: 0; background-color: #7b1fa2;" onclick="selectColor('Purple')"></div>
                                    <div style="margin: 8px; width: 24px; height: 24px; flex-shrink: 0; background-color: #303f9f;" onclick="selectColor('Indigo')"></div>
                                    <div style="margin: 8px; width: 24px; height: 24px; flex-shrink: 0; background-color: #0288d1;" onclick="selectColor('Light_Blue')"></div>
                                    <div style="margin: 8px; width: 24px; height: 24px; flex-shrink: 0; background-color: #00796b;" onclick="selectColor('Teal')"></div>
                                    <div style="margin: 8px; width: 24px; height: 24px; flex-shrink: 0; background-color: #388e3c;" onclick="selectColor('Green')"></div>   
                                    <div style="margin: 8px;width: 24px; height: 24px; flex-shrink: 0; background-color: #afb42b;" onclick="selectColor('Lime')"></div>
                                    <div style="margin: 8px; width: 24px; height: 24px; flex-shrink: 0; background-color: #ffd600;" onclick="selectColor('Yellow')"></div>
                                    <div style="margin: 8px; width: 24px; height: 24px; flex-shrink: 0; background-color: #ff6d00;" onclick="selectColor('Orange')"></div>
                                    <div style="margin: 8px; width: 24px; height: 24px; flex-shrink: 0; background-color: #455a64;" onclick="selectColor('Blue_Grey')"></div>
                                    <div style="margin: 8px; width: 24px; height: 24px; flex-shrink: 0; background-color: #000000;" onclick="selectColor('Black')"></div>                              
                                </div>
                                <button class="mdc-icon-button material-icons">palette</button>
                            </div>
                            <div style="width: 48px; height: 48px;" onclick="openPopup('listPopupParagraph')">                            
                                <div id='listPopupParagraph' style="z-index: 100; display: none; background: #eee; position: absolute; margin-top: -50px; border: 1px #eee solid; border-radius: 4px; box-shadow: #0000006c 0px 1px 4px 1px">
                                    <button id="nl_paragraph" class="mdc-icon-button material-icons" style="display: block;" onclick="disableSiblings('nl_paragraph', ['nl_paragraph', 'ol_paragraph', 'ul_paragraph'])">reorder</button>
                                    <button id="ol_paragraph" class="mdc-icon-button material-icons" style="display: block;" onclick="disableSiblings('ol_paragraph', ['nl_paragraph', 'ol_paragraph', 'ul_paragraph'])">format_list_numbered</button>
                                    <button id="ul_paragraph" class="mdc-icon-button material-icons" style="display: block;" onclick="disableSiblings('ul_paragraph', ['nl_paragraph', 'ol_paragraph', 'ul_paragraph'])">format_list_bulleted</button>                            
                                </div>
                                <button class="mdc-icon-button material-icons">checklist</button>
                            </div>
                        </div>
                    </div>
                    <div id="iconsEditorHolder" style="width:100%">
                        <h4 style="margin-top: 8px; margin-bottom: 0px;">Выберите иконку</h4>
                        <div id="iconsHolderTrue" style="display: flex; flex-direction: row; flex-wrap: wrap; justify-content: space-between;"></div>
                    </div>
                    <div id="linkEditorHolder" style="width: 100%;">
                        <label class="mdc-text-field mdc-text-field--outlined mdc-text-field--textarea" style="margin-top: 16px;">
                            <span class="mdc-notched-outline">
                              <span class="mdc-notched-outline__leading"></span>
                              <span class="mdc-notched-outline__notch">
                                <span class="mdc-floating-label" id="task2EditLabel">Текст-описание ссылки</span>
                              </span>
                              <span class="mdc-notched-outline__trailing"></span>
                            </span>
                            <span class="mdc-text-field__resizer">
                              <textarea class="mdc-text-field__input" id="linkTextEditTextArea" rows="1" cols="100" aria-label="Label" required minlength="3"></textarea>
                            </span>
                        </label>
                        <label class="mdc-text-field mdc-text-field--outlined mdc-text-field--textarea" style="margin-top: 16px;">
                            <span class="mdc-notched-outline">
                              <span class="mdc-notched-outline__leading"></span>
                              <span class="mdc-notched-outline__notch">
                                <span class="mdc-floating-label" id="task2EditLabel">URL ссылки</span>
                              </span>
                              <span class="mdc-notched-outline__trailing"></span>
                            </span>
                            <span class="mdc-text-field__resizer">
                              <textarea class="mdc-text-field__input" id="linkUrlEditTextArea" rows="1" cols="100" aria-label="Label" required minlength="3"></textarea>
                            </span>
                        </label>
                        <div class="mdc-form-field">
                            <div class="mdc-checkbox">
                              <input type="checkbox"
                                     class="mdc-checkbox__native-control"
                                     id="checkboxLockUrl"/>
                              <div class="mdc-checkbox__background">
                                <svg class="mdc-checkbox__checkmark"
                                     viewBox="0 0 24 24">
                                  <path class="mdc-checkbox__checkmark-path"
                                        fill="none"
                                        d="M1.73,12.91 8.1,19.28 22.79,4.59"/>
                                </svg>
                                <div class="mdc-checkbox__mixedmark"></div>
                              </div>
                              <div class="mdc-checkbox__ripple"></div>
                            </div>
                            <label for="checkboxLockUrl">Блокировать все ниже без предосмотра ссылки</label>
                          </div>
                    </div>
                    <div id="imageEditorHolder" style="width: 100%;">
                        <div style="width: 100%; display: flex; flex-direction: row; flex-wrap: wrap;">
                            <button class="mdc-button mdc-button--raised" id="imageUploadButton" style="margin-right:16px;" onclick="uploadImage();">
                                <span class="mdc-button__ripple"></span>
                                <i class="material-icons mdc-button__icon" aria-hidden="true">add_photo_alternate</i>
                                <span class="mdc-button__label">Выбрать</span>
                            </button>
                            <input type="file" id="upload_image" style="width: 0px;" accept="image/*">
                            <div class="mdc-form-field" style="flex-grow: 1; flex-shrink: 1;">
                                <div class="mdc-checkbox">
                                  <input type="checkbox"
                                         class="mdc-checkbox__native-control"
                                         id="checkboxInvertImage"/>
                                  <div class="mdc-checkbox__background">
                                    <svg class="mdc-checkbox__checkmark"
                                         viewBox="0 0 24 24">
                                      <path class="mdc-checkbox__checkmark-path"
                                            fill="none"
                                            d="M1.73,12.91 8.1,19.28 22.79,4.59"/>
                                    </svg>
                                    <div class="mdc-checkbox__mixedmark"></div>
                                  </div>
                                  <div class="mdc-checkbox__ripple"></div>
                                </div>
                                <label for="checkboxInvertImage">Инвертировать в темной теме</label>
                            </div>
                        </div>
                        <label class="mdc-text-field mdc-text-field--outlined mdc-text-field--textarea" style="margin-top: 16px;">
                            <span class="mdc-notched-outline">
                              <span class="mdc-notched-outline__leading"></span>
                              <span class="mdc-notched-outline__notch">
                                <span class="mdc-floating-label" id="task3EditLabel">Подпись рисунка</span>
                              </span>
                              <span class="mdc-notched-outline__trailing"></span>
                            </span>
                            <span class="mdc-text-field__resizer">
                              <textarea class="mdc-text-field__input" id="imageTextEditTextArea" rows="1" cols="100" aria-label="Label"></textarea>
                            </span>
                        </label>
                        <p class="card__text" id="loadingImageText" style="margin-bottom: 16px;display: none;">Loading...</p>
                        <div role="progressbar" id="loadingImageProgress" style="width: 100%;display: none;" class="mdc-linear-progress mdc-linear-progress--indeterminate" aria-label="Example Progress Bar" aria-valuemin="0" aria-valuemax="1" aria-valuenow="0">
                            <div class="mdc-linear-progress__buffer">
                                <div class="mdc-linear-progress__buffer-bar"></div>
                                <div class="mdc-linear-progress__buffer-dots"></div>
                            </div>
                            <div class="mdc-linear-progress__bar mdc-linear-progress__primary-bar">
                                <span class="mdc-linear-progress__bar-inner"></spa>
                            </div>
                            <div class="mdc-linear-progress__bar mdc-linear-progress__secondary-bar">
                                <span class="mdc-linear-progress__bar-inner"></span>
                            </div>
                        </div>
                    </div>
                    <div id="fileEditorHolder" style="width: 100%;">
                        <div style="width: 100%; display: flex; flex-direction: row; flex-wrap: wrap;">
                            <button class="mdc-button mdc-button--raised" id="fileUploadButton" style="margin-right:16px;" onclick="uploadFile();">
                                <span class="mdc-button__ripple"></span>
                                <i class="material-icons mdc-button__icon" aria-hidden="true">attach_file</i>
                                <span class="mdc-button__label">Выбрать</span>
                            </button>
                            <input type="file" id="upload_file" style="width: 0px;" accept=".pdf">
                            <div class="mdc-form-field" style="flex-grow: 1; flex-shrink: 1;">
                                <div class="mdc-checkbox">
                                  <input type="checkbox"
                                         class="mdc-checkbox__native-control"
                                         id="checkboxLockerFile"/>
                                  <div class="mdc-checkbox__background">
                                    <svg class="mdc-checkbox__checkmark"
                                         viewBox="0 0 24 24">
                                      <path class="mdc-checkbox__checkmark-path"
                                            fill="none"
                                            d="M1.73,12.91 8.1,19.28 22.79,4.59"/>
                                    </svg>
                                    <div class="mdc-checkbox__mixedmark"></div>
                                  </div>
                                  <div class="mdc-checkbox__ripple"></div>
                                </div>
                                <label for="checkboxLockerFile">Блокировать, пока не открыт</label>
                            </div>
                        </div>
                        <label class="mdc-text-field mdc-text-field--outlined mdc-text-field--textarea" style="margin-top: 16px;">
                            <span class="mdc-notched-outline">
                              <span class="mdc-notched-outline__leading"></span>
                              <span class="mdc-notched-outline__notch">
                                <span class="mdc-floating-label" id="task4EditLabel">Название файла</span>
                              </span>
                              <span class="mdc-notched-outline__trailing"></span>
                            </span>
                            <span class="mdc-text-field__resizer">
                              <textarea class="mdc-text-field__input" id="fileTextEditTextArea" rows="1" cols="100" aria-label="Label" required minlength="3"></textarea>
                            </span>
                        </label>
                        <p class="card__text" id="loadingFileText" style="margin-bottom: 16px;display: none;">Loading...</p>
                        <div role="progressbar" id="loadingFileProgress" style="width: 100%;display: none;" class="mdc-linear-progress mdc-linear-progress--indeterminate" aria-label="Example Progress Bar" aria-valuemin="0" aria-valuemax="1" aria-valuenow="0">
                            <div class="mdc-linear-progress__buffer">
                                <div class="mdc-linear-progress__buffer-bar"></div>
                                <div class="mdc-linear-progress__buffer-dots"></div>
                            </div>
                            <div class="mdc-linear-progress__bar mdc-linear-progress__primary-bar">
                                <span class="mdc-linear-progress__bar-inner"></spa>
                            </div>
                            <div class="mdc-linear-progress__bar mdc-linear-progress__secondary-bar">
                                <span class="mdc-linear-progress__bar-inner"></span>
                            </div>
                        </div>
                    </div>
                    <div id="testProgramEditorHolder" style="width: 100%;">
                        <div class="mdc-select mdc-select--outlined" id="testProgramUnitSelector" style="margin-top: 8px; margin-bottom: 8px; width: 100%;">
                            <div class="mdc-select__anchor" aria-labelledby="outlined-select-label">
                                <span class="mdc-notched-outline">
                                    <span class="mdc-notched-outline__leading"></span>
                                    <span class="mdc-notched-outline__notch">
                                        <span id="outlined-select-label" class="mdc-floating-label">Выберите лекцию</span>
                                    </span>
                                    <span class="mdc-notched-outline__trailing"></span>
                                </span>
                                <span class="mdc-select__selected-text-container">
                                    <span id="testUnit-selected-text" class="mdc-select__selected-text"></span>
                                </span>
                                <span class="mdc-select__dropdown-icon">
                                    <svg class="mdc-select__dropdown-icon-graphic" viewBox="7 10 10 5" focusable="false">
                                    <polygon class="mdc-select__dropdown-icon-inactive" stroke="none" fill-rule="evenodd" points="7 10 12 15 17 10"></polygon>
                                    <polygon class="mdc-select__dropdown-icon-active" stroke="none" fill-rule="evenodd" points="7 15 12 10 17 15"></polygon>
                                </svg>
                              </span>
                            </div>
                            <div class="mdc-select__menu mdc-menu mdc-menu-surface mdc-menu-surface--fullwidth">
                                <ul id="testProgramList" class="mdc-list">
                                    
                                </ul>
                            </div>
                        </div>
                        <label class="mdc-text-field mdc-text-field--outlined mdc-text-field--textarea" style="margin-top: 8px;">
                            <span class="mdc-notched-outline">
                              <span class="mdc-notched-outline__leading"></span>
                              <span class="mdc-notched-outline__notch">
                                <span class="mdc-floating-label" id="task5EditLabel">Название теста</span>
                              </span>
                              <span class="mdc-notched-outline__trailing"></span>
                            </span>
                            <span class="mdc-text-field__resizer">
                              <textarea class="mdc-text-field__input" id="testProgramTextEditTextArea" rows="1" cols="100" aria-label="Label" required minlength="3"></textarea>
                            </span>
                        </label>
                        <h4 style="margin-top: 8px; margin-bottom: 0px;">Выберите режим</h4>
                        <div style="width: 100%; display: flex; flex-direction: row; flex-wrap: wrap;">
                            <div class="mdc-form-field" style="margin-right: 16px;">
                                <div class="mdc-radio">
                                    <input class="mdc-radio__native-control" type="radio" id="radioFree" name="radios" checked>
                                    <div class="mdc-radio__background">
                                      <div class="mdc-radio__outer-circle"></div>
                                      <div class="mdc-radio__inner-circle"></div>
                                    </div>
                                    <div class="mdc-radio__ripple"></div>
                                </div>
                                <label for="radioFree">Свободный</label>
                            </div>
                            <div class="mdc-form-field" style="margin-right: 16px;">
                                <div class="mdc-radio">
                                    <input class="mdc-radio__native-control" type="radio" id="radioTraining" name="radios">
                                    <div class="mdc-radio__background">
                                      <div class="mdc-radio__outer-circle"></div>
                                      <div class="mdc-radio__inner-circle"></div>
                                    </div>
                                    <div class="mdc-radio__ripple"></div>
                                </div>
                                <label for="radioTraining">Тренинг</label>
                            </div>
                            <div class="mdc-form-field" style="margin-right: 16px;">
                                <div class="mdc-radio">
                                    <input class="mdc-radio__native-control" type="radio" id="radioControl" name="radios">
                                    <div class="mdc-radio__background">
                                        <div class="mdc-radio__outer-circle"></div>
                                        <div class="mdc-radio__inner-circle"></div>
                                    </div>
                                    <div class="mdc-radio__ripple"></div>
                                </div>
                                <label for="radioControl">Контроль</label>
                            </div>
                            <div class="mdc-form-field" style="margin-right: 16px;">
                                <div class="mdc-radio">
                                    <input class="mdc-radio__native-control" type="radio" id="radioKrok" name="radios">
                                    <div class="mdc-radio__background">
                                        <div class="mdc-radio__outer-circle"></div>
                                        <div class="mdc-radio__inner-circle"></div>
                                    </div>
                                    <div class="mdc-radio__ripple"></div>
                                </div>
                                <label for="radioKrok">КРОК</label>
                            </div>
                        </div>
                        <h4 style="margin-top: 8px; margin-bottom: 0px;">Настройки</h4>
                        <div class="mdc-form-field" style="flex-grow: 1; flex-shrink: 1;">
                            <div class="mdc-checkbox">
                                <input type="checkbox" class="mdc-checkbox__native-control" id="checkboxAllowSave"/>
                                <div class="mdc-checkbox__background">
                                    <svg class="mdc-checkbox__checkmark" viewBox="0 0 24 24">
                                        <path class="mdc-checkbox__checkmark-path" fill="none" d="M1.73,12.91 8.1,19.28 22.79,4.59"/>
                                    </svg>
                                    <div class="mdc-checkbox__mixedmark"></div>
                                </div>
                                <div class="mdc-checkbox__ripple"></div>
                            </div>
                            <label for="checkboxAllowSave">Разрешить сохранение заметок и создание изображения тестов</label>
                        </div>
                        <div class="mdc-form-field" style="flex-grow: 1; flex-shrink: 1;">
                            <div class="mdc-checkbox">
                                <input type="checkbox" class="mdc-checkbox__native-control" id="checkboxLockerTestProgram"/>
                                <div class="mdc-checkbox__background">
                                    <svg class="mdc-checkbox__checkmark" viewBox="0 0 24 24">
                                        <path class="mdc-checkbox__checkmark-path" fill="none" d="M1.73,12.91 8.1,19.28 22.79,4.59"/>
                                    </svg>
                                    <div class="mdc-checkbox__mixedmark"></div>
                                </div>
                                <div class="mdc-checkbox__ripple"></div>
                            </div>
                            <label for="checkboxLockerTestProgram">Блокировать, пока не пройдено тестирование на %</label>
                        </div>
                        <label class="mdc-text-field mdc-text-field--outlined mdc-text-field--textarea" id="testProgramMinPercentHolder" style="margin-top: 16px; margin-bottom: 8px;">
                            <span class="mdc-notched-outline">
                                <span class="mdc-notched-outline__leading"></span>
                                <span class="mdc-notched-outline__notch">
                                    <span class="mdc-floating-label" id="task8EditLabel">Минимальный % прохождения</span>
                                </span>
                                <span class="mdc-notched-outline__trailing"></span>
                            </span>
                            <span class="mdc-text-field__resizer">
                                <textarea class="mdc-text-field__input" id="testProgramMinPercent" rows="1" cols="100" aria-label="Label" required minlength="1"></textarea>
                            </span>
                        </label>
                        <div class="mdc-form-field" id="checkboxMixTestHolder" style="flex-grow: 1; flex-shrink: 1; margin-bottom: 8px;">
                            <div class="mdc-checkbox">
                                <input type="checkbox" class="mdc-checkbox__native-control" id="checkboxMixTest"/>
                                <div class="mdc-checkbox__background">
                                    <svg class="mdc-checkbox__checkmark" viewBox="0 0 24 24">
                                        <path class="mdc-checkbox__checkmark-path" fill="none" d="M1.73,12.91 8.1,19.28 22.79,4.59"/>
                                    </svg>
                                    <div class="mdc-checkbox__mixedmark"></div>
                                </div>
                                <div class="mdc-checkbox__ripple"></div>
                            </div>
                            <label for="checkboxMixTest">Перемешивать тесты</label>
                        </div>
                        <div style="display: flex; width: 100%; align-items: center;" id="countHolder">
                            <p class="card__text" style="margin-left: 0px;">С</p>
                            <label class="mdc-text-field mdc-text-field--outlined mdc-text-field--textarea"">
                                <span class="mdc-notched-outline">
                                  <span class="mdc-notched-outline__leading"></span>
                                  <span class="mdc-notched-outline__trailing"></span>
                                </span>
                                <span class="mdc-text-field__resizer">
                                  <textarea class="mdc-text-field__input" id="testProgramFrom" rows="1" cols="15" aria-label="Label"></textarea>
                                </span>
                            </label>
                            <p class="card__text">по</p>
                            <label class="mdc-text-field mdc-text-field--outlined mdc-text-field--textarea"">
                                <span class="mdc-notched-outline">
                                  <span class="mdc-notched-outline__leading"></span>
                                  <span class="mdc-notched-outline__trailing"></span>
                                </span>
                                <span class="mdc-text-field__resizer">
                                  <textarea class="mdc-text-field__input" id="testProgramTo" rows="1" cols="15" aria-label="Label"></textarea>
                                </span>
                            </label>
                            <p class="card__text">тесты</p>
                        </div>
                        <div style="display: flex; width: 100%; align-items: center;" id="randomHolder">
                            <label class="mdc-text-field mdc-text-field--outlined mdc-text-field--textarea">
                                <span class="mdc-notched-outline">
                                  <span class="mdc-notched-outline__leading"></span>
                                  <span class="mdc-notched-outline__trailing"></span>
                                </span>
                                <span class="mdc-text-field__resizer">
                                  <textarea class="mdc-text-field__input" id="testProgramRand" rows="1" cols="10" aria-label="Label"></textarea>
                                </span>
                            </label>
                            <p class="card__text">случайных тестов</p>
                        </div>
                    </div>
                    <h4 style="margin-top: 8px; margin-bottom: 8px;">Превью</h4>
                    <div id="previewHolder"></div>

                </section>
                <footer class="mdc-dialog__actions">
                    <button type="button" class="mdc-button mdc-dialog__button mdc-ripple-upgraded" onclick="cancel()">Отмена</button>
                    <button type="button" class="mdc-button mdc-dialog__button mdc-ripple-upgraded" onclick="accept()">Сохранить</button>
                </footer>
            </div>
        </div>
    </div>
    <div id="loadingTemplate" style="bottom: 0; top: 0; right: 0; left: 0; position: absolute;background-color: #fff; display: none; align-items: center; flex-direction: row; z-index: 10000;">
        <div style="display: flex; width: 100%; align-items: center; flex-direction: column;">
            <p class="card__text" id="loadingText">Loading...</p>
            <div style="width: 100%; height: 20px;"></div>
            <div role="progressbar" style="width: 80%;" id="loadingLinearProgress" class="mdc-linear-progress mdc-linear-progress--indeterminate" aria-label="Example Progress Bar" aria-valuemin="0" aria-valuemax="1" aria-valuenow="0">
                <div class="mdc-linear-progress__buffer">
                  <div class="mdc-linear-progress__buffer-bar"></div>
                  <div class="mdc-linear-progress__buffer-dots"></div>
                </div>
                <div class="mdc-linear-progress__bar mdc-linear-progress__primary-bar">
                  <span class="mdc-linear-progress__bar-inner"></span>
                </div>
                <div class="mdc-linear-progress__bar mdc-linear-progress__secondary-bar">
                  <span class="mdc-linear-progress__bar-inner"></span>
                </div>
            </div>
        </div>
    </div>
    
    <template id="presenterCardTemplate">
        <div class='mdc-card' style="margin-top: 6px; margin-bottom: 8px; background-color: #fff; margin-left: 16px; margin-right: 16px;">
            <div class="card__presenter_holder"></div>
            <div class="mdc-card__actions">
                <div class="mdc-card__action-buttons">
                    <button class="mdc-button mdc-card__action mdc-card__action--button">
                        <div class="mdc-button__ripple"></div>
                        <span class="mdc-button__label">Изменить презентер</span>
                    </button>
                </div>
                <div class="mdc-card__action-icons">
                    <button class="material-icons mdc-icon-button mdc-card__action mdc-card__action--icon">delete</button>
                    <button class="material-icons mdc-icon-button mdc-card__action mdc-card__action--icon">expand_less</button>
                    <button class="material-icons mdc-icon-button mdc-card__action mdc-card__action--icon">expand_more</button>
                </div>
        </div>
    </template>
    <template id="listItemTemplate">
        <li class="mdc-list-item">
            <span class="mdc-list-item__ripple"></span>
            <span class="mdc-list-item__text"></span>
        </li>
    </template>
    <template id="textinputTemplate">
        <label class="mdc-text-field mdc-text-field--outlined" style="flex-grow: 1; margin: 10px 0 4px 0; width: 100%;">
            <span class="mdc-notched-outline">
                <span class="mdc-notched-outline__leading"></span>
                <span class="mdc-notched-outline__trailing"></span>
            </span>
            <input type="text" class="mdc-text-field__input" aria-label="answerTextLabel">
        </label>
        <p class="card__text negative__answer"></p>
    </template>

    <script type="text/javascript">
        const EDITOR_MODE = 'presenters';
        const dialog = new mdc.dialog.MDCDialog(document.getElementById('main-dialog'));
        const dialogEdit = new mdc.dialog.MDCDialog(document.getElementById('edit-dialog'));
        const dialogTitle = document.getElementById('main-dialog-title');
        const dialogContent = document.getElementById('main-dialog-content');
        const selector = '.mdc-button, .mdc-fab, .mdc-icon-button, .mdc-card__primary-action, .mdc-icon-button';
        const testListMainPage = document.getElementById('testListMainPage');
        const saveButton = document.getElementById('saveButton');
        const linearProgress = document.getElementById('loadingLinearProgress');
        const loadingTemplate = document.getElementById('loadingTemplate');
        const loadingText = document.getElementById('loadingText');
        const fab = document.getElementById('fab');
        menues = [].map.call(document.querySelectorAll('.mdc-text-field'), function(el) {
            return new mdc.textField.MDCTextField(el);
        });
        texts3 = [].map.call(document.querySelectorAll('.mdc-select'), function(el) {
            return new mdc.select.MDCSelect(el);
        });
        toggles = [].map.call(document.querySelectorAll('.mdc-icon-button'), function(el) {
            return new mdc.iconButton.MDCIconButtonToggle(el);
        });
        radios = [].map.call(document.querySelectorAll('.mdc-radio'), function(el) {
            return new mdc.radio.MDCRadio(el);
        });
        fields = [].map.call(document.querySelectorAll('.mdc-form-field'), function(el) {
            return new mdc.formField.MDCFormField(el);
        });
        progresses = [].map.call(document.querySelectorAll('.mdc-linear-progress'), function(el) {
            return new mdc.linearProgress.MDCLinearProgress(el);
        });
        let ripples;
        let texts;

        const firebaseApi = new FireBaseAPI();
        let author = 'Kozlov';

        let currentFork = null;
        let forksArray = [];
        let currentUnit = null;
        let currentUnitsArray = [];
        let currentPresenter = null;
        let currentPresenterArray = [];
        let currentPresenterArrayShadow = [];

        document.addEventListener('DOMContentLoaded', () => {
            fab.classList.add('mdc-fab--exited');
            InfoCard.FillIcons();
            fab.addEventListener('click', () => {
                const newPresenter = Presenter.CreateEmptyPresenter(currentUnit.unitId, currentFork.name, currentPresenterArray.length);
                currentPresenterArray.push(newPresenter);
                currentPresenter = newPresenter;
                dialogEdit.open();
                newPresenter.GetPresenterEdit();
            });
            firebaseApi.readForks(author);
        });

        function updateClone(){
            let el = document.getElementById('edit_dialog-dialog-content');
            let elClone = el.cloneNode(true);
            el.parentNode.replaceChild(elClone, el);
            menues = [].map.call(document.querySelectorAll('.mdc-text-field'), function(el) {
                return new mdc.textField.MDCTextField(el);
            });
            texts3 = [].map.call(document.querySelectorAll('.mdc-select'), function(el) {
                return new mdc.select.MDCSelect(el);
            });
            toggles = [].map.call(document.querySelectorAll('.mdc-icon-button'), function(el) {
                return new mdc.iconButton.MDCIconButtonToggle(el);
            });
            radios = [].map.call(document.querySelectorAll('.mdc-radio'), function(el) {
                return new mdc.radio.MDCRadio(el);
            });
            fields = [].map.call(document.querySelectorAll('.mdc-form-field'), function(el) {
                return new mdc.formField.MDCFormField(el);
            });
            progresses = [].map.call(document.querySelectorAll('.mdc-linear-progress'), function(el) {
                return new mdc.linearProgress.MDCLinearProgress(el);
            });
        }

        function uploadImage(){
            document.getElementById('upload_image').click();
        }

        function uploadFile(){
            document.getElementById('upload_file').click();
        }

        function selectColor(color){
            if(currentPresenter != null){
                currentPresenter.OnEditAction(null, color)
            }
        }

        function openPopup(id){
            const element = document.getElementById(id);
            if(element.style.display === 'none'){
                element.style.display = 'block';
            }
            else{
                element.style.display = 'none';
            }
        }

        function disableSiblings(id, siblings = null){
            if(siblings == null){
                siblings = InfoCard.GetListOfIds();
            }
            if(!siblings){
                document.getElementById(id).classList.toggle('toggle_on');
            }
            else{
                document.getElementById(id).classList.add('toggle_on');
                for(let i = 0; i < siblings.length; i++){
                    if(siblings[i] != id){
                        document.getElementById(siblings[i]).classList.remove('toggle_on');
                    }
                }
            }
            if(currentPresenter != null){
                currentPresenter.OnEditAction(id, null)
            }
        }

        function accept(){
            if(currentPresenter != null){
                if(currentPresenter.SavePresenter()){
                    dialog.close();
                    while (dialogContent.firstChild) {
                        dialogContent.removeChild(dialogContent.lastChild);
                    }
                    currentPresenter = null;
                    Presenter.ReDraw();
                    saveButton.disabled = false;
                }
            }
            else if(currentUnit != null){
                if(currentUnit.SaveUnit()){
                    dialog.close();
                    while (dialogContent.firstChild) {
                        dialogContent.removeChild(dialogContent.lastChild);
                    }
                }
            }
            else if(currentFork != null){
                if(currentFork.SaveFork()){
                    dialog.close();
                    while (dialogContent.firstChild) {
                        dialogContent.removeChild(dialogContent.lastChild);
                    }
                }
            }
        }

        function progressToUi(action = '', show = true){
            if(show){
                linearProgress.style.display = 'block';
                loadingTemplate.style.display = 'flex';
            }
            else{
                linearProgress.style.display = 'none';
                setTimeout(() => {
                    loadingTemplate.style.display = 'none';
                }, 2000);
            }
            loadingText.innerText = action;
        }

        function cancel(){
            while (dialogContent.firstChild) {
                dialogContent.removeChild(dialogContent.lastChild);
            }
            dialog.close();
        }

        function import_file(){
            document.getElementById('upload_file').click();
        }

        function save_file(){
            firebaseApi.writePresenters();
        }

        function coreSignalHandler(signal, mode = ''){
            console.log(signal + ' ' + mode);
            switch(signal){
                case firebaseApi.Signals.forksLoaded:
                case firebaseApi.Signals.forksEmpty:
                    Fork.DrawForks();
                    break;
                case firebaseApi.Signals.unitLoaded:
                case firebaseApi.Signals.unitEmpty:
                    Unit.DrawUnits();
                    break;
                case firebaseApi.Signals.presentersFinished:
                    Presenter.ReDraw();
                    break;
                case firebaseApi.Signals.presentersEmpty:
                    fab.classList.remove('mdc-fab--exited');
                    break;
                case firebaseApi.Signals.presentersLoaded:
                    if(mode == firebaseApi.Mode.read){
                        Presenter.ReDraw();
                        fab.classList.remove('mdc-fab--exited');
                    }
                    break;
                case firebaseApi.Signals.forksFailed:
                    firebaseApi.readForks(author);
                    break;
            }
        }
    </script>
</body>

</html>