<!doctype html>

<html lang="en">

<head>
    <meta charset="utf-8">

    <title>My successful KROK blog</title>
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
    <meta name="description" content="">
    <meta name="author" content="Damir A. Kutikov">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <script src="https://www.gstatic.com/firebasejs/9.1.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.1/firebase-database-compat.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="material.css">
    <script src="material.js"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link href="style.css" rel="stylesheet">
    <link href="statistics/styles.css" rel="stylesheet">
    <script src="Unit.js"></script>
    <script src="Fork.js"></script>
    <script src="FireBaseAPI.js"></script>
    <script src="buckets/Bucket.js"></script>
    <script src="tests/TestAccont.js"></script>
    <script src="statistics/Account.js"></script>
    <script src="statistics/date.js"></script>
    <script src="statistics/Fail.js"></script>
    <script src="statistics/Day.js"></script>
    <script src="statistics/PassedLection.js"></script>
    <script src="statistics/PassedTesting.js"></script>
    <script src="statistics/chart.js"></script>
</head>

<body style="background-color: #f0f0f0; margin: 0;">
    <aside class="mdc-drawer mdc-drawer--modal">
        <div class="mdc-drawer__content">
            <div style="display: flex;">
                <button id="backBurger" onclick="drawer2.open = false"
                    class="mdc-icon-button material-icons">arrow_back</button>
                <h3 class="card__text console__title">Закрыть</h3>
            </div>
            <div id="modalDrawer">
            </div>
        </div>
    </aside>
    <div class="mdc-drawer-scrim"></div>
    <div
        style="display: flex; bottom: 0; top: 0; right: 0; left: 0; position: absolute; flex-direction: column; align-items: stretch;">
        <div
            style="display: flex; flex-direction: row; align-items: center;flex-grow: 0; flex-shrink: 0; flex-wrap: wrap; background-color: #fff; box-shadow: 0px 2px 8px #00000075;">
            <div class="mdc-select mdc-select--outlined"
                style="display:none; margin-top: 16px; margin-left: 16px; margin-right: 16px; margin-bottom: 8px;  flex-grow: 1;  flex-shrink: 1;">
                <div class="mdc-select__anchor" aria-labelledby="outlined-select-label">
                    <span class="mdc-notched-outline">
                        <span class="mdc-notched-outline__leading"></span>
                        <span class="mdc-notched-outline__notch">
                            <span id="outlined-select-label" class="mdc-floating-label">Модуль</span>
                        </span>
                        <span class="mdc-notched-outline__trailing"></span>
                    </span>
                    <span class="mdc-select__selected-text-container">
                        <span id="forks-selected-text" class="mdc-select__selected-text"></span>
                    </span>
                    <span class="mdc-select__dropdown-icon">
                        <svg class="mdc-select__dropdown-icon-graphic" viewBox="7 10 10 5" focusable="false">
                            <polygon class="mdc-select__dropdown-icon-inactive" stroke="none" fill-rule="evenodd"
                                points="7 10 12 15 17 10"></polygon>
                            <polygon class="mdc-select__dropdown-icon-active" stroke="none" fill-rule="evenodd"
                                points="7 15 12 10 17 15"></polygon>
                        </svg>
                    </span>
                </div>
                <div class="mdc-select__menu mdc-menu mdc-menu-surface mdc-menu-surface--fullwidth">
                    <ul id="forksList" class="mdc-list"></ul>
                </div>
            </div>
            <div class="mdc-select mdc-select--outlined"
                style="display:none;margin-top: 16px; margin-left: 16px; margin-right: 16px; margin-bottom: 8px; flex-grow: 1; flex-shrink: 1;">
                <div class="mdc-select__anchor" aria-labelledby="outlined-select-label">
                    <span class="mdc-notched-outline">
                        <span class="mdc-notched-outline__leading"></span>
                        <span class="mdc-notched-outline__notch">
                            <span id="outlined-select-label" class="mdc-floating-label">Лекция</span>
                        </span>
                        <span class="mdc-notched-outline__trailing"></span>
                    </span>
                    <span class="mdc-select__selected-text-container">
                        <span id="units-selected-text" class="mdc-select__selected-text"></span>
                    </span>
                    <span class="mdc-select__dropdown-icon">
                        <svg class="mdc-select__dropdown-icon-graphic" viewBox="7 10 10 5" focusable="false">
                            <polygon class="mdc-select__dropdown-icon-inactive" stroke="none" fill-rule="evenodd"
                                points="7 10 12 15 17 10"></polygon>
                            <polygon class="mdc-select__dropdown-icon-active" stroke="none" fill-rule="evenodd"
                                points="7 15 12 10 17 15"></polygon>
                        </svg>
                    </span>
                </div>
                <div class="mdc-select__menu mdc-menu mdc-menu-surface mdc-menu-surface--fullwidth">
                    <ul id="unitsList" class="mdc-list"></ul>
                </div>
            </div>
            <div style="display: flex; margin-left:16px; flex-grow: 1; flex-shrink: 0;">
                <button id="burger" class="mdc-icon-button material-icons" style="margin-left: -16px;">menu</button>
                <h3 id="pageTitleL" class="card__text console__title">Рейтинг ошибок</h3>
            </div>
            <div style="display: flex; margin-left:16px; flex-shrink: 0; height: 52px;">
                <button class="mdc-button mdc-button--raised" id="saveButton"
                    style="margin-right:16px; margin-top: 8px; margin-bottom: 8px;display: none;" onclick="save_file();" disabled>
                    <span class="mdc-button__ripple"></span>
                    <i class="material-icons mdc-button__icon" aria-hidden="true">save</i>
                    <span class="mdc-button__label">Сохранить</span>
                </button>
            </div>

        </div>
        <div style="display: flex; flex-direction: row; flex-wrap: nowrap; height: auto; flex-grow: 1; height: 1px;">
            <div style="width: 256px; flex-grow: 0; flex-shrink: 0;" id="drawerHolder">
                <aside id="fixedDrawer" class="mdc-drawer mdc-drawer--fixed">
                    <div class="mdc-drawer__content">
                        <div class="mdc-drawer__header">
                            <h3 class="mdc-drawer__title">Alexander KOZLOV</h3>
                            <h6 class="mdc-drawer__subtitle">kozlov@karazin.ua</h6>
                        </div>
                        <div class="mdc-list" aria-orientation="vertical" id="drawerRootFixed">
                            <a class="mdc-list-item accordion" href="javascript:drawerHandler('PRESENTERS');">
                                <span class="mdc-list-item__ripple"></span>
                                <i class="material-icons mdc-list-item__graphic" aria-hidden="true">widgets</i>
                                <span class="mdc-list-item__text"
                                    style="text-transform: uppercase; font-weight: 600;">Презентеры</span>
                            </a>
                            <a class="mdc-list-item accordion" href="javascript:drawerHandler('TESTS');">
                                <span class="mdc-list-item__ripple"></span>
                                <i class="material-icons mdc-list-item__graphic" aria-hidden="true">checklist</i>
                                <span class="mdc-list-item__text"
                                    style="text-transform: uppercase; font-weight: 600;">Тесты</span>
                            </a>
                            <a class="mdc-list-item mdc-list-item--activated accordion"
                                href="javascript:drawerHandler('STATISTICS');">
                                <span class="mdc-list-item__ripple"></span>
                                <i class="material-icons mdc-list-item__graphic"
                                    aria-hidden="true">insert_chart_outlined</i>
                                <span class="mdc-list-item__text"
                                    style="text-transform: uppercase; font-weight: 600;">Статистика</span>
                                <span aria-hidden="true" class="material-icons mdc-list-item__meta accordionIcon"
                                    style="margin-left: auto;">expand_less</span>
                            </a>
                            <div style="max-height: 12000px; background-color: #f5f5f5;">
                                <div class="mdc-list" aria-orientation="vertical" style="margin-left: 16px;">
                                    <a class="mdc-list-item mdc-list-item--activated accordion" aria-current="page" id="FailsItem"
                                        href="javascript:drawerHandler('FAILS');">
                                        <span class="mdc-list-item__ripple"></span>
                                        <i class="material-icons mdc-list-item__graphic" aria-hidden="true">report</i>
                                        <span class="mdc-list-item__text">Ошибки</span>
                                    </a>
                                    <a class="mdc-list-item accordion" aria-current="page" id="AccountItem"
                                        href="javascript:drawerHandler('ACCOUNTS');">
                                        <span class="mdc-list-item__ripple"></span>
                                        <i class="material-icons mdc-list-item__graphic" aria-hidden="true">people</i>
                                        <span class="mdc-list-item__text">Пользователи</span>
                                    </a>
                                </div>
                            </div>
                            <a class="mdc-list-item accordion" href="javascript:drawerHandler('BUCKETS');">
                                <span class="mdc-list-item__ripple"></span>
                                <i class="material-icons mdc-list-item__graphic" aria-hidden="true">monetization_on</i>
                                <span class="mdc-list-item__text"
                                    style="text-transform: uppercase; font-weight: 600;">Бакеты</span>
                            </a>
                            <a class="mdc-list-item accordion" href="javascript:drawerHandler('SCHEMAS');">
                                <span class="mdc-list-item__ripple"></span>
                                <i class="material-icons mdc-list-item__graphic" aria-hidden="true">schema</i>
                                <span class="mdc-list-item__text"
                                    style="text-transform: uppercase; font-weight: 600;">Схемы</span>
                            </a>
                            <a class="mdc-list-item accordion" href="javascript:drawerHandler('MANUALS');">
                                <span class="mdc-list-item__ripple"></span>
                                <i class="material-icons mdc-list-item__graphic" aria-hidden="true">description</i>
                                <span class="mdc-list-item__text"
                                    style="text-transform: uppercase; font-weight: 600;">Мануал</span>
                            </a>
                        </div>
                    </div>
                </aside>
            </div>
            <div id="testListMainPage" class="testListMainPage">

                <div id="ratingPanel"></div>

                <div id="accountsPanel"
                    style="display: none; flex-direction: row; flex-wrap: wrap; margin-right: 8px; margin-left: 8px;justify-content: space-between;">
                    <div class="mdc-select mdc-select--outlined"
                        style="width: 100px; flex-grow: 1; flex-basis: 100%; margin-top: 8px; margin-bottom: 4px;">
                        <div class="mdc-select__anchor" aria-labelledby="outlined-select-label">
                            <span class="mdc-notched-outline">
                                <span class="mdc-notched-outline__leading"></span>
                                <span class="mdc-notched-outline__notch">
                                    <span class="mdc-floating-label"
                                        style="transform: translateY(-23px) scale(0.75);">Выберите аккаунт</span>
                                </span>
                                <span class="mdc-notched-outline__trailing"></span>
                            </span>
                            <span class="mdc-select__selected-text-container">
                                <span style="margin-top: 6px;" class="mdc-select__selected-text"
                                    id="selectedAccount"></span>
                            </span>
                            <span class="mdc-select__dropdown-icon">
                                <svg class="mdc-select__dropdown-icon-graphic" viewBox="7 10 10 5" focusable="false">
                                    <polygon class="mdc-select__dropdown-icon-inactive" stroke="none"
                                        fill-rule="evenodd" points="7 10 12 15 17 10"></polygon>
                                    <polygon class="mdc-select__dropdown-icon-active" stroke="none" fill-rule="evenodd"
                                        points="7 15 12 10 17 15"></polygon>
                                </svg>
                            </span>
                        </div>
                        <div class="mdc-select__menu mdc-menu mdc-menu-surface mdc-menu-surface--fullwidth">
                            <ul class="mdc-list" id="accountsList">

                            </ul>
                        </div>
                    </div>
                    <div class="mdc-card statistics_card">
                        <p class="card__text card_title">График тестирования</p>
                        <div style="width: 100%; height: 244px; margin-top: -12px; padding-right: 4px; padding-left: 4px;"
                            id="graphicHolder">
                        </div>
                        <table style="margin-right: 12px; margin-left: 12px;">
                            <tbody>
                                <tr>
                                    <td colspan="3">
                                        <div
                                            style="display: flex; flex-direction: row; flex-wrap: nowrap; margin-right: 12px; margin-left: 12px;">
                                            <i class="material-icons" style="color: #2b2b2b; cursor: pointer;"
                                                onclick="changeDate(-1);">chevron_left</i>
                                            <p class="card__text"
                                                style="margin-top: 0; margin-bottom: 0; font-weight: 600; flex-grow: 1; justify-content: center; text-align: center;"
                                                id="currentDate">Устройство №2</p>
                                            <i class="material-icons" style="color: #2b2b2b; cursor: pointer;"
                                                onclick="changeDate(+1)">chevron_right</i>
                                        </div>
                                    </td>
                                </tr>
                                <tr style="padding-top: 0px; padding-bottom: 0px;">
                                    <td style="width: 33%; text-align: center; vertical-align: middle; font-size: 1.5rem; font-weight: 800; color: #000;"
                                        class="card__text" id="allTestsDay">0</td>
                                    <td style="width: 33%; text-align: center; vertical-align: middle; font-size: 1.5rem; font-weight: 800; color: #2e7d32;"
                                        class="card__text" id="correctTestsDay">0</td>
                                    <td style="width: 33%; text-align: center; vertical-align: middle; font-size: 1.5rem; font-weight: 800; color: #00695c; padding-top: 0px;"
                                        class="card__text" id="percentDay">0%</td>
                                </tr>
                                <tr style="padding-top: 0px; padding-bottom: 0px;">
                                    <td style="width: 33%; text-align: center; vertical-align:top; font-size: 0.75rem; color: #000;"
                                        class="card__text">пройдено тестов</td>
                                    <td style="width: 33%; text-align: center; vertical-align:top; font-size: 0.75rem; color: #2e7d32;"
                                        class="card__text">отвечено верно</td>
                                    <td style="width: 33%; text-align: center; vertical-align:top; font-size: 0.75rem; color: #00695c;"
                                        class="card__text">верных тестов</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="mdc-card statistics_card">
                        <p class="card__text card_title">Устройства</p>
                        <table style="margin-left: 4px; margin-right: 4px; margin-top: -6px;">
                            <tr>
                                <th colspan="2">
                                    <div
                                        style="display: flex; flex-direction: row; flex-wrap: nowrap; margin-right:4px; margin-left: 4px;">
                                        <i class="material-icons" style="color: #2e7d32;">devices</i>
                                        <p class="card__text"
                                            style="margin-top: 0; margin-bottom: 0; color: #2e7d32; font-weight: 600;">
                                            Устройство №1
                                        </p>
                                    </div>
                                </th>
                            </tr>
                            <tbody>
                                <tr>
                                    <td class="card__text card_item_text">Модель</td>
                                    <td class="card__text card_item_text" id="devMod1">-</td>
                                </tr>
                                <tr>
                                    <td class="card__text card_item_text">Версия Android</td>
                                    <td class="card__text card_item_text" id="devOs1">-</td>
                                </tr>
                                <tr>
                                    <td class="card__text card_item_text">ID устройства</td>
                                    <td class="card__text card_item_text" id="devId1">-</td>
                                </tr>
                                <tr>
                                    <td class="card__text card_item_text">Активировано</td>
                                    <td class="card__text card_item_text" id="devAct1">-</td>
                                </tr>
                                <tr>
                                    <td class="card__text card_item_text">Последняя синхронизация</td>
                                    <td class="card__text card_item_text" id="devSync1">-</td>
                                </tr>
                            </tbody>
                            <tr>
                                <th colspan="2">
                                    <div
                                        style="display: flex; flex-direction: row; flex-wrap: nowrap; margin-right:4px; margin-left: 4px;">
                                        <i class="material-icons" style="color: #1565c0;">devices</i>
                                        <p class="card__text"
                                            style="margin-top: 0; margin-bottom: 0; color: #1565c0; font-weight: 600;">
                                            Устройство №2
                                        </p>
                                    </div>
                                </th>
                            </tr>
                            <tbody>
                                <tr>
                                    <td class="card__text card_item_text">Модель</td>
                                    <td class="card__text card_item_text" id="devMod2">-</td>
                                </tr>
                                <tr>
                                    <td class="card__text card_item_text">Версия Android</td>
                                    <td class="card__text card_item_text" id="devOs2">-</td>
                                </tr>
                                <tr>
                                    <td class="card__text card_item_text">ID устройства</td>
                                    <td class="card__text card_item_text" id="devId2">-</td>
                                </tr>
                                <tr>
                                    <td class="card__text card_item_text">Активировано</td>
                                    <td class="card__text card_item_text" id="devAct2">-</td>
                                </tr>
                                <tr>
                                    <td class="card__text card_item_text">Последняя синхронизация</td>
                                    <td class="card__text card_item_text" id="devSync2">-</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="mdc-card statistics_card">
                        <p class="card__text card_title">Купленные бакеты</p>
                        <table style="margin-left: 4px; margin-right: 4px;" cellpadding="0" cellspacing="0">
                            <tr>
                                <th class="nameTextBuckets" style="font-weight: 600;">Название</th>
                                <td class="authorTextBuckets" style="font-weight: 600;">Автор</td>
                                <th class="upToBucket" style="font-weight: 600;">Актуален до</th>
                                <th class="actionButtonBucket" style="font-weight: 600;">Действия</th>
                            </tr>
                            <tbody id='passedBucketsHolder' class="table_testings"></tbody>
                        </table>
                    </div>
                    <div class="mdc-card statistics_card">
                        <p class="card__text card_title">Ошибки в тестах</p>
                        <table style="margin-left: 4px; margin-right: 4px;" cellpadding="0" cellspacing="0">
                            <tr>
                                <th class="forkTextFails" style="font-weight: 600;">Раздел</th>
                                <th class="unitTextFails" style="font-weight: 600;">Лекция</th>
                                <td class="deviceTextFails">devices</td>
                                <th class="createdTextFails" style="font-weight: 600;">Время</th>
                                <th class="viewTextFails">visibility</th>
                            </tr>
                            <tbody id='failsHolder' class="table_testings"></tbody>
                        </table>
                    </div>
                    <div class="mdc-select mdc-select--outlined"
                        style="width: 100px; flex-grow: 1; flex-basis: 100%; margin-top: 8px; margin-bottom: 4px;">
                        <div class="mdc-select__anchor" aria-labelledby="outlined-select-label">
                            <span class="mdc-notched-outline">
                                <span class="mdc-notched-outline__leading"></span>
                                <span class="mdc-notched-outline__notch">
                                    <span class="mdc-floating-label"
                                        style="transform: translateY(-23px) scale(0.75);">Выберите раздел</span>
                                </span>
                                <span class="mdc-notched-outline__trailing"></span>
                            </span>
                            <span class="mdc-select__selected-text-container">
                                <span style="margin-top: 6px;" class="mdc-select__selected-text"
                                    id="selectedFork"></span>
                            </span>
                            <span class="mdc-select__dropdown-icon">
                                <svg class="mdc-select__dropdown-icon-graphic" viewBox="7 10 10 5" focusable="false">
                                    <polygon class="mdc-select__dropdown-icon-inactive" stroke="none"
                                        fill-rule="evenodd" points="7 10 12 15 17 10"></polygon>
                                    <polygon class="mdc-select__dropdown-icon-active" stroke="none" fill-rule="evenodd"
                                        points="7 15 12 10 17 15"></polygon>
                                </svg>
                            </span>
                        </div>
                        <div class="mdc-select__menu mdc-menu mdc-menu-surface mdc-menu-surface--fullwidth">
                            <ul class="mdc-list" id="forksList2">

                            </ul>
                        </div>
                    </div>
                    <div class="mdc-card statistics_card">
                        <p class="card__text card_title">Пройденные тестирования</p>
                        <table style="margin-left: 4px; margin-right: 4px;" cellpadding="0" cellspacing="0">
                            <tr>
                                <th class="unitTextTesting" style="font-weight: 600;">Название</th>
                                <td class="deviceTextTestings">devices</td>
                                <th class="dateTextTesting" style="font-weight: 600;">Начат</th>
                                <th class="durationTextTesting" style="font-weight: 600;">В работе</th>
                                <th class="testsTextTesting" style="font-weight: 600;">%</th>
                                <th class="percentTextTesting" style="font-weight: 600;">Всего</th>
                            </tr>
                            <tbody id='passedTestingsHolder' class="table_testings"></tbody>
                        </table>
                    </div>
                    <div class="mdc-card statistics_card">
                        <p class="card__text card_title">Пройденные лекции</p>
                        <table style="margin-left: 4px; margin-right: 4px;" cellpadding="0" cellspacing="0">
                            <tr>
                                <th class="unitTextLections" style="font-weight: 600;">Название</th>
                                <td class="deviceTextLections">devices</td>
                                <th class="startedTextLections" style="font-weight: 600;">Начато</th>
                                <th class="finishedTextLections" style="font-weight: 600;">Окончено</th>
                                <th class="durationTextLections" style="font-weight: 600;">В работе</th>
                            </tr>
                            <tbody id='passedLectionsHolder' class="table_testings"></tbody>
                        </table>
                    </div>
                </div>

            </div>
        </div>
    </div>
    <div id="main-dialog" class="mdc-dialog" role="alertdialog" aria-modal="true"
        aria-labelledby="mdc-dialog-with-list-label" aria-describedby="mdc-dialog-with-list-description"
        bis_skin_checked="1">
        <div class="mdc-dialog__scrim" bis_skin_checked="1"></div>
        <div class="mdc-dialog__container" bis_skin_checked="1">
            <div class="mdc-dialog__surface" bis_skin_checked="1">
                <h2 id="main-dialog-title" class="mdc-dialog__title">Ошибка в тесте</h2>
                <section id="main-dialog-content" class="mdc-dialog__content">
                    <p class="card__text card__task"></p>
                    <div class="card__answers_list"></div>
                    <p class="card__text card__comment"></p>
                </section>
                <footer class="mdc-dialog__actions">
                    <button type="button" class="mdc-button mdc-dialog__button mdc-ripple-upgraded"
                        onclick="cancel()">Отмена</button>
                </footer>
            </div>
        </div>
    </div>

    <template id="ratingCardTemplate">
        <div class='mdc-card'
            style="margin-top: 6px; margin-bottom: 8px; background-color: #fff; margin-left: 16px; margin-right: 16px; padding-bottom: 12px;">
            <table style="margin-top: 6px; margin-left: 8px; margin-right: 8px;">
                <tbody>
                    <tr style="background-color: #eee;">
                        <td class="ratingTableForkT">Раздел</td>
                        <td class="ratingTableFork">-</td>
                    </tr>
                    <tr>
                        <td class="ratingTableUnitT">Лекция</td>
                        <td class="ratingTableUnit">-</td>
                    </tr>
                    <tr style="background-color: #eee;">
                        <td class="ratingTableCountT">Ошибок</td>
                        <td class="ratingTableCount">-</td>
                    </tr>
                </tbody>
            </table>
            <p class="card__text card__task"></p>
            <div class="card__answers_list"></div>
            <p class="card__text card__comment"></p>
        </div>
    </template>
    <div id="loadingTemplate"
        style="bottom: 0; top: 0; right: 0; left: 0; position: absolute;background-color: #fff; display: none; align-items: center; flex-direction: row; z-index: 10000;">
        <div style="display: flex; width: 100%; align-items: center; flex-direction: column;">
            <p class="card__text" id="loadingText">Loading...</p>
            <div style="width: 100%; height: 20px;"></div>
            <div role="progressbar" style="width: 80%;" class="mdc-linear-progress mdc-linear-progress--indeterminate"
                aria-label="Example Progress Bar" aria-valuemin="0" aria-valuemax="1" aria-valuenow="0">
                <div class="mdc-linear-progress__buffer">
                    <div class="mdc-linear-progress__buffer-bar"></div>
                    <div class="mdc-linear-progress__buffer-dots"></div>
                </div>
                <div class="mdc-linear-progress__bar mdc-linear-progress__primary-bar">
                    <span class="mdc-linear-progress__bar-inner"></span>
                </div>
                <div class="mdc-linear-progress__bar mdc-linear-progress__secondary-bar">
                    <span class="mdc-linear-progress__bar-inner"></span>
                </div>
            </div>
        </div>
    </div>

    <template id="answerCardPositiveTemplate">
        <div style="display: flex; flex-direction: row; align-items: center;">
            <span class="material-icons-answer positive__answer">done</span>
            <p class="card__text card__answer positive__answer"></p>
        </div>
    </template>
    <template id="answerCardNegativeTemplate">
        <div style="display: flex; flex-direction: row; align-items: center;">
            <span class="material-icons-answer negative__answer">clear</span>
            <p class="card__text card__answer negative__answer"></p>
        </div>
    </template>
    <template id="listItemTemplate">
        <li class="mdc-list-item">
            <span class="mdc-list-item__ripple"></span>
            <span class="mdc-list-item__text"></span>
        </li>
    </template>
    <template id="textinputTemplate">
        <label class="mdc-text-field mdc-text-field--outlined" style="flex-grow: 1; margin: 10px 0 4px 0; width: 100%;">
            <span class="mdc-notched-outline">
                <span class="mdc-notched-outline__leading"></span>
                <span class="mdc-notched-outline__trailing"></span>
            </span>
            <input type="text" class="mdc-text-field__input" aria-label="answerTextLabel">
        </label>
        <p class="card__text negative__answer"></p>
    </template>

    <script type="text/javascript">
        const dialog = new mdc.dialog.MDCDialog(document.getElementById('main-dialog'));
        const dialogTitle = document.getElementById('main-dialog-title');
        const dialogContent = document.getElementById('main-dialog-content');
        const selector = '.mdc-button, .mdc-fab, .mdc-icon-button, .mdc-card__primary-action, .mdc-icon-button, .mdc-list-item';
        const testListMainPage = document.getElementById('testListMainPage');
        const importButton = document.getElementById('importButton');
        const saveButton = document.getElementById('saveButton');
        const linearProgress = document.querySelector('.mdc-linear-progress');
        const linearProgress1 = new mdc.linearProgress.MDCLinearProgress(document.querySelector('.mdc-linear-progress'));
        const loadingTemplate = document.getElementById('loadingTemplate');
        const loadingText = document.getElementById('loadingText');
        const drawer2 = mdc.drawer.MDCDrawer.attachTo(document.querySelector('.mdc-drawer--modal'));
        menues = [].map.call(document.querySelectorAll('.mdc-select'), function (el) {
            return new mdc.select.MDCSelect(el);
        });
        let ripples;
        let texts;

        const firebaseApi = new FireBaseAPI();


        const graphicHolder = document.getElementById('graphicHolder');
        const forksSelector = document.getElementById('selectedFork');
        const forksList = document.getElementById('forksList2');
        const accountsSelector = document.getElementById('selectedAccount');
        const accountsList = document.getElementById('accountsList');
        let chart;
        const author = getCookie('author');

        let forksArray = [];
        let allBucketsArray = [];
        const allUsersArray = [];
        const forksNamesArray = [];
        const allRating = [];

        let allFailsArr = [];
        let allTestingsArr = [];
        let allLecionsArr = [];

        let renderDate = Date.today();
        let data1 = null;
        const daysObj = {};

        document.addEventListener('DOMContentLoaded', () => {
            switch (author) {
                case 'Kutikov':
                    document.querySelector('.mdc-drawer__title').innerText = 'Дамир КУТИКОВ';
                    document.querySelector('.mdc-drawer__subtitle').innerText = 'damirkut@gmail.com';
                    break;
                case 'Kozlov':
                    document.querySelector('.mdc-drawer__title').innerText = 'Александр КОЗЛОВ';
                    document.querySelector('.mdc-drawer__subtitle').innerText = 'kozlov@karazin.ua';
                    break;
                case 'Site':
                    document.querySelector('.mdc-drawer__title').innerText = 'ИЗИ КРОК';
                    document.querySelector('.mdc-drawer__subtitle').innerText = 'easykrok@karazin.ua';
                    break;
            }
            document.getElementById('burger').addEventListener('click', function () {
                drawer2.open = !drawer2.open;
            });
            window.addEventListener('resize', function (event) {
                resize();
            }, true);
            resize();
            changeDate(0);
            Day.GetChart();
        });

        function changeDate(int) {
            renderDate = renderDate.addDays(int);
            document.getElementById('currentDate').innerText = renderDate.toString("ddd, d MMMM yyyy");
            Day.ResultsOnDay(renderDate.toString("dd.MM.yy"));
        }

        function MStoDate(ms) {
            return new Date(ms).addMinutes(new Date(ms).getTimezoneOffset());
        }

        function getCookie(name) {
            const value = `; ${document.cookie}`;
            const parts = value.split(`; ${name}=`);
            if (parts.length === 2) {
                return parts.pop().split(';').shift();
            }
            return null;
        }

        function accept() {
        }

        function progressToUi(action = '', show = true) {
            if (show) {
                linearProgress.style.display = 'block';
                loadingTemplate.style.display = 'flex';
            }
            else {
                linearProgress.style.display = 'none';
                setTimeout(() => {
                    loadingTemplate.style.display = 'none';
                }, 2000);
            }
            loadingText.innerText = action;
        }

        function cancel() {
            dialog.close();
        }

        function save_file() {
        }

        function resize() {
            const modalDrawer = document.getElementById('modalDrawer');
            const fixedDrawer = document.getElementById('fixedDrawer');
            if (window.innerWidth < 256 + 32 + 800) {
                document.getElementById('drawerHolder').style.display = 'none';
                document.getElementById('burger').style.display = 'block';
                modalDrawer.append(fixedDrawer.children[0] || '');
                while (fixedDrawer.firstChild) {
                    fixedDrawer.removeChild(fixedDrawer.firstChild)
                }
            }
            else {
                drawer2.open = false;
                document.getElementById('drawerHolder').style.display = 'block';
                document.getElementById('burger').style.display = 'none';
                fixedDrawer.append(modalDrawer.children[0] || '');
                while (modalDrawer.firstChild) {
                    modalDrawer.removeChild(modalDrawer.firstChild)
                }
            }
            if (data1 != null) {
                while (graphicHolder.lastChild) {
                    graphicHolder.removeChild(graphicHolder.firstChild);
                }
                const canvas = document.createElement('canvas');
                canvas.width = graphicHolder.clientWidth;
                canvas.height = graphicHolder.clientHeight;
                graphicHolder.append(canvas);
                chart = new Chart(canvas, {
                    type: 'line',
                    data: data1,
                    options: {
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
            }
        }

        function updateDesign() {
            ripples = [].map.call(document.querySelectorAll(selector), function (el) {
                return new mdc.ripple.MDCRipple(el);
            });
            list = [].map.call(document.querySelectorAll('.mdc-list'), function (el) {
                return new mdc.list.MDCList(el);
            });
            listItemRipples = [].map.call(document.querySelectorAll(selector), function (el) {
                return new mdc.ripple.MDCRipple(el);
            });
            menues = [].map.call(document.querySelectorAll('.mdc-select'), function (el) {
                return new mdc.select.MDCSelect(el);
            });
        }

        function drawUnitsAndForks() {
            const accordions = document.querySelectorAll('.accordion');
            for (let i = 0; i < accordions.length; i++) {
                accordions[i].addEventListener("click", function () {
                    this.classList.toggle("active");
                    const panel = this.nextElementSibling;
                    if (panel.style.maxHeight) {
                        panel.style.maxHeight = null;
                        this.querySelector('.accordionIcon').innerText = 'expand_more';
                    }
                    else {
                        panel.style.maxHeight = panel.scrollHeight + "px";
                        this.querySelector('.accordionIcon').innerText = 'expand_less';
                    }
                });
            }
            updateDesign();
        }

        function ratingRenderer(order) {
            const nextI = order + 1;
            if (allRating.length > nextI) {
                if (forksNamesArray.includes(allRating[nextI].fork)) {
                    firebaseApi.getTestById(allRating[nextI].testId, nextI.toString());
                }
                else {
                    ratingRenderer(nextI);
                }
            }
            else{
                progressToUi('All loaded!', false);
            }
        }

        function drawerHandler(str) {
            const thisPage = "statistics";
            drawer2.open = false;
            switch (str) {
                case 'BUCKETS':
                    window.open(window.location.toString().replaceAll(thisPage, "buckets"), "_self");
                    break;
                case 'PRESENTERS':
                    window.open(window.location.toString().replaceAll(thisPage, "presenters"), "_self");
                    break;
                case 'STATISTICS':
                    window.open(window.location.toString().replaceAll(thisPage, "statistics"), "_parent");
                    break;
                case 'MANUALS':
                    window.open(window.location.toString().replaceAll(thisPage, "manuals"), "_self");
                    break;
                case 'TESTS':
                    window.open(window.location.toString().replaceAll(thisPage, "tests"), "_self");
                    break;
                case 'SCHEMAS':
                    window.open(window.location.toString().replaceAll(thisPage, "schemas"), "_self");
                    break;
                case 'FAILS':
                    document.getElementById('ratingPanel').style.display = 'block';
                    document.getElementById('accountsPanel').style.display = 'none';
                    document.getElementById('FailsItem').classList.toggle('mdc-list-item--activated');
                    document.getElementById('AccountItem').classList.toggle('mdc-list-item--activated');
                    document.getElementById('pageTitleL').innerText = 'Рейтинг ошибок';
                    break;
                case 'ACCOUNTS':
                    document.getElementById('ratingPanel').style.display = 'none';
                    document.getElementById('accountsPanel').style.display = 'flex';
                    document.getElementById('FailsItem').classList.toggle('mdc-list-item--activated');
                    document.getElementById('AccountItem').classList.toggle('mdc-list-item--activated');
                    document.getElementById('pageTitleL').innerText = 'Пользователи';
                    break;
            }
        }

        function coreSignalHandler(signal, mode = '') {
            console.log(signal + ' ' + mode);
            progressToUi('Loading contents...');
            switch (signal) {
                case firebaseApi.Signals.loggedIn:
                    firebaseApi.readForks(author);
                    break;
                case firebaseApi.Signals.firestoreAuth:
                    for (let i = 0; i < allUsersArray.length; i++) {
                        const listItem = document.getElementById('listItemTemplate').content.cloneNode(true);
                        listItem.querySelector('.mdc-list-item__text').innerText = allUsersArray[i].email;
                        listItem.querySelector('.mdc-list-item').dataset.value = allUsersArray[i].email;
                        accountsList.appendChild(listItem);
                    }
                    accountsSelector.addEventListener("DOMSubtreeModified", (i) => {
                        if (accountsSelector.innerText != '') {
                            for (let j = 0; j < allUsersArray.length; j++) {
                                if (allUsersArray[j].email == accountsSelector.innerText) {
                                    progressToUi('Loading contents...');
                                    firebaseApi.readAccount(allUsersArray[j].email, allUsersArray[j].server);
                                }
                            }
                        }
                    });
                    firebaseApi.readFailsRating();
                    //progressToUi('All loaded!', false);
                    break;
                case firebaseApi.Signals.firestoreRead:
                    Day.GetChart();
                    Fail.Draw(allFailsArr, forksNamesArray);
                    forksSelector.innerText = '';
                    progressToUi('All loaded!', false);
                    break;
                case firebaseApi.Signals.firestoreRatingRead:
                    ratingRenderer(-1);
                    break;
                case firebaseApi.Signals.forksLoaded:
                case firebaseApi.Signals.forksEmpty:
                    firebaseApi.readAllBuckets();
                    for (let i = 0; i < forksArray.length; i++) {
                        forksNamesArray.push(forksArray[i].name);
                        const listItem = document.getElementById('listItemTemplate').content.cloneNode(true);
                        listItem.querySelector('.mdc-list-item__text').innerText = forksArray[i].name;
                        listItem.querySelector('.mdc-list-item').dataset.value = forksArray[i].name;
                        forksList.appendChild(listItem);
                    }
                    const listItem = document.getElementById('listItemTemplate').content.cloneNode(true);
                    listItem.querySelector('.mdc-list-item__text').innerText = 'Работа над ошибками';
                    listItem.querySelector('.mdc-list-item').dataset.value = 'Работа над ошибками';
                    forksList.appendChild(listItem);
                    forksSelector.addEventListener("DOMSubtreeModified", (i) => {
                        if (forksSelector.innerText != '') {
                            PassedTesting.Draw(allTestingsArr, forksSelector.innerText);
                            PassedLection.Draw(allLecionsArr, forksSelector.innerText);
                        }
                        else {
                            PassedTesting.Wipe();
                            PassedLection.Wipe();
                        }
                    });
                    break;
                case firebaseApi.Signals.bucketsLoaded:
                    firebaseApi.loadAllUsers();
                    break;
                case firebaseApi.Signals.usersListLoaded:
                    firebaseApi.authSecondServer();
                    break;
                case firebaseApi.Signals.forksFailed:
                    firebaseApi.readForks(author);
                    break;
            }
        }
    </script>
</body>

</html>